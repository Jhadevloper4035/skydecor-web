<% if (products && products.length > 0) { %>
  <% products.forEach(product => { %>
    <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
      <div class="product-wrap mb-25 scroll-zoom">
        <div class="product-img">
          <a href="/products/detail/<%= product.productCode %>">
            <!-- Lazy load images with fixed width/height and async decoding -->
            <img 
              class="default-img" 
              src="<%= product.image %>" 
              alt="<%= product.productName %>" 
              loading="lazy" 
              decoding="async" 
              width="371" height="480">
            <img 
              class="hover-img" 
              src="<%= product.image %>" 
              alt="<%= product.productName %>" 
              loading="lazy" 
              decoding="async" 
              width="371" height="480">
          </a>

          <div class="product-action">
            <div class="pro-same-action pro-wishlist">
              <a title="Download" href="/products/download/<%= product.productCode %>">
                <i class="pe-7s-download"></i>
              </a>
            </div>

            <div class="pro-same-action pro-cart">
              <a title="View Product" href="/products/detail/<%= product.productCode %>">
                View Product
              </a>
            </div>

            <div class="pro-same-action pro-quickview">
              <a title="Quick View" href="#" data-bs-toggle="modal" data-bs-target="#exampleModal"
                data-productcode="<%= product.productCode %>"
                data-producttype="<%= product.productType %>"
                data-name="<%= product.productName %>"
                data-image="<%= product.image %>"
                data-category="<%= product.category %>"
                data-subcategory="<%= product.subCategory %>"
                data-texture="<%= product.texture %>"
                data-design="<%= product.design %>"
                data-size="<%= product.size %>"
                data-thickness="<%= product.thickness %>"
                data-width="<%= product.width %>"
                data-downloadlink="<%= product.downloadLink %>">
                <i class="pe-7s-look"></i>
              </a>
            </div>
          </div>
        </div>

        <div class="product-content text-left">
          <h3>
            <a href="/product-details/<%= product.id %>">
              <%= product.productCode %> <br>
              <%= product.category %> - <%= product.texture %>
            </a>
          </h3>
        </div>
      </div>
    </div>
  <% }) %>
<% } else { %>
  <p class="text-center">No products found.</p>
<% } %>
